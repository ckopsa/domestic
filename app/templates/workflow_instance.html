{% extends "base.html" %}

{% block content %}
    <h1>Workflow: {{ instance.name }}</h1>
    <a href="/workflow-instances/{{ instance.id }}/dashboard" class="action-button" style="margin-bottom:15px; display:inline-block;">View Read-only Dashboard</a>
    <div class="workflow-details">
        <p><strong>ID:</strong> {{ instance.id }}</p>
        <p><strong>Status:</strong> {{ instance.status.upper() }}</p>
        <p><strong>Created At:</strong> {{ instance.created_at.isoformat() }}</p>
        <h2>Tasks:</h2>
        {% if not tasks %}
            <p>No tasks available for this workflow.</p>
        {% else %}
            <ul>
                {% for task in tasks %}
                    <li class="task-item" style="margin-bottom:10px;">
                        <p><strong>Task:</strong> {{ task.name }} - {{ task.status.upper() }}</p>
                        {% if task.status == "pending" %}
                            <form action="/task-instances/{{ task.id }}/complete" method="post" style="display:inline; margin-left:10px;">
                                <button type="submit" class="action-button submit">Mark Complete</button>
                            </form>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
        {% if instance.status == "completed" %}
            <p style="color: green; font-weight: bold; font-size:1.2em; margin-top:15px;">🎉 Workflow Complete!</p>
        {% endif %}
    </div>
    <a href="/workflow-definitions" class="back-link" style="margin-top:20px; display:inline-block;">← Back to Workflow Definitions</a>
    <a href="/" class="back-link" style="margin-top:20px; display:inline-block; margin-left:15px;">← Back to Home</a>
{% endblock %}
